function factory(a){function b(a){var b,c;return a?/^ws(s)?:\/\//.test(a)?a:/:\d{1,5}/.test(a)?(b="https:"===window.location.protocol?"wss://":"ws://",b+a):"/"===a[0]?(b="https:"===window.location.protocol?"wss://":"ws://",c=""!==window.location.port?":"+window.location.port:"",b+window.location.hostname+c+a):(b="https:"===window.location.protocol?"wss://":"ws://",b+a):(b="https:"===window.location.protocol?"wss://":"ws://",c=""!==window.location.port?":"+window.location.port:"",b+window.location.hostname+c+"/ws")}function c(a){return/^ws(s)?:\/\//.test(a)?a:null}function d(d,e,f){var h=g?c(d):b(d);return h?f?new f(h,e):g?null:"WebSocket"in a?new a.WebSocket(h,e):"MozWebSocket"in a?new a.MozWebSocket(h,e):null:null}var e={HELLO:1,WELCOME:2,ABORT:3,CHALLENGE:4,AUTHENTICATE:5,GOODBYE:6,HEARTBEAT:7,ERROR:8,PUBLISH:16,PUBLISHED:17,SUBSCRIBE:32,SUBSCRIBED:33,UNSUBSCRIBE:34,UNSUBSCRIBED:35,EVENT:36,CALL:48,CANCEL:49,RESULT:50,REGISTER:64,REGISTERED:65,UNREGISTER:66,UNREGISTERED:67,INVOCATION:68,INTERRUPT:69,YIELD:70},f={SUCCESS:{code:0,description:"Success!"},URI_ERROR:{code:1,description:"Topic URI doesn't meet requirements!"},NO_BROKER:{code:2,description:"Server doesn't provide broker role!"},NO_CALLBACK_SPEC:{code:3,description:"No required callback function specified!"},INVALID_PARAM:{code:4,description:"Invalid parameter(s) specified!"},NON_EXIST_SUBSCRIBE_CONFIRM:{code:5,description:"Received subscribe confirmation to non existent subscription!"},NON_EXIST_SUBSCRIBE_ERROR:{code:6,description:"Received error for non existent subscription!"},NON_EXIST_UNSUBSCRIBE:{code:7,description:"Trying to unsubscribe from non existent subscription!"},NON_EXIST_SUBSCRIBE_UNSUBSCRIBED:{code:8,description:"Received unsubscribe confirmation to non existent subscription!"},NON_EXIST_PUBLISH_ERROR:{code:9,description:"Received error for non existent publication!"},NON_EXIST_PUBLISH_PUBLISHED:{code:10,description:"Received publish confirmation for non existent publication!"},NON_EXIST_SUBSCRIBE_EVENT:{code:11,description:"Received event for non existent subscription!"},NO_DEALER:{code:12,description:"Server doesn't provide dealer role!"},NON_EXIST_CALL_RESULT:{code:13,description:"Received rpc result for non existent call!"},NON_EXIST_CALL_ERROR:{code:14,description:"Received rpc call error for non existent call!"},RPC_ALREADY_REGISTERED:{code:15,description:"RPC already registered!"},NON_EXIST_RPC_REG:{code:16,description:"Received rpc registration confirmation for non existent rpc!"},NON_EXIST_RPC_UNREG:{code:17,description:"Received rpc unregistration for non existent rpc!"},NON_EXIST_RPC_ERROR:{code:18,description:"Received error for non existent rpc!"},NON_EXIST_RPC_INVOCATION:{code:19,description:"Received invocation for non existent rpc!"},NON_EXIST_RPC_REQ_ID:{code:20,description:"No RPC calls in action with specified request ID!"},NO_REALM:{code:21,description:"No realm specified!"},NO_WS_OR_URL:{code:22,description:"No websocket provided or URL specified is incorrect!"}},g="object"==typeof process&&"[object process]"===Object.prototype.toString.call(process),h=function(a,b){switch(this.version="v2.0.1",this._url="string"==typeof arguments[0]?a:null,this._protocols=["wamp.2.json"],this._wamp_features={agent:"Wampy.js "+this.version,roles:{publisher:{features:{subscriber_blackwhite_listing:!0,publisher_exclusion:!0,publisher_identification:!0}},subscriber:{},caller:{features:{callee_blackwhite_listing:!0,caller_exclusion:!0,caller_identification:!0,progressive_call_results:!0,call_canceling:!0}},callee:{features:{caller_identification:!0}}}},this._cache={sessionId:null,server_wamp_features:{roles:{}},isSayingGoodbye:!1,opStatus:{code:0,description:"Success!",reqId:0},timer:null,reconnectingAttempts:0},this._ws=null,this._wsQueue=[],this._requests={},this._calls={},this._subscriptions={},this._subsTopics=[],this._rpcRegs={},this._rpcNames=[],this._options={debug:!1,autoReconnect:!0,reconnectInterval:2e3,maxRetries:25,transportEncoding:"json",realm:null,onConnect:null,onClose:null,onError:null,onReconnect:null,ws:null,msgpackCoder:null},arguments.length){case 1:"string"!=typeof arguments[0]&&(this._options=this._merge(this._options,arguments[0]));break;case 2:this._options=this._merge(this._options,b)}this.connect()};h.prototype._log=function(){this._options.debug&&a.console.log(arguments)},h.prototype._getReqId=function(){var a;do a=Math.floor(1e14*Math.random());while(a in this._requests);return a},h.prototype._merge=function(){var a,b,c={},d=arguments.length;for(a=0;d>a;a++)for(b in arguments[a])c[b]=arguments[a][b];return c},h.prototype._isArray=function(a){return!!a&&a.constructor===Array},h.prototype._isPlainObject=function(a){return!!a&&a.constructor===Object},h.prototype._setWsProtocols=function(){this._options.msgpackCoder&&("msgpack"===this._options.transportEncoding?this._protocols=["wamp.2.msgpack","wamp.2.json"]:this._protocols=["wamp.2.json","wamp.2.msgpack"])},h.prototype._validateURI=function(a){var b=/^([0-9a-zA-Z_]{2,}\.)*([0-9a-zA-Z_]{2,})$/;return b.test(a)&&0!==a.indexOf("wamp")?!0:!1},h.prototype._encode=function(a){if("msgpack"!==this._options.transportEncoding||!this._options.msgpackCoder)return JSON.stringify(a);try{return this._options.msgpackCoder.encode(a)}catch(b){throw new Error("[wampy] msgpack encode exception!")}},h.prototype._decode=function(a){if("msgpack"!==this._options.transportEncoding||!this._options.msgpackCoder)return JSON.parse(a);try{return this._options.msgpackCoder.decode(new Uint8Array(a))}catch(b){throw new Error("[wampy] msgpack decode exception!")}},h.prototype._send=function(a){if(a&&this._wsQueue.push(this._encode(a)),this._ws&&1===this._ws.readyState&&this._cache.sessionId)for(;this._wsQueue.length;)this._ws.send(this._wsQueue.shift())},h.prototype._resetState=function(){this._wsQueue=[],this._subscriptions={},this._subsTopics=[],this._requests={},this._calls={},this._rpcRegs={},this._rpcNames=[],this._cache={reconnectingAttempts:0}},h.prototype._initWsCallbacks=function(){var a=this;this._ws&&(this._ws.onopen=function(){a._wsOnOpen.call(a)},this._ws.onclose=function(b){a._wsOnClose.call(a,b)},this._ws.onmessage=function(b){a._wsOnMessage.call(a,b)},this._ws.onerror=function(b){a._wsOnError.call(a,b)})},h.prototype._wsOnOpen=function(){this._log("[wampy] websocket connected"),this._ws.protocol&&(this._options.transportEncoding=this._ws.protocol.split(".")[2]),"msgpack"===this._options.transportEncoding&&(this._ws.binaryType="arraybuffer"),this._ws.send(this._encode([e.HELLO,this._options.realm,this._wamp_features]))},h.prototype._wsOnClose=function(){var a=this,b=g?global:window;this._log("[wampy] websocket disconnected"),(this._cache.sessionId||this._cache.reconnectingAttempts)&&this._options.autoReconnect&&this._cache.reconnectingAttempts<this._options.maxRetries&&!this._cache.isSayingGoodbye?(this._cache.sessionId=null,this._cache.timer=b.setTimeout(function(){a._wsReconnect.call(a)},this._options.reconnectInterval)):(this._options.onClose&&this._options.onClose(),this._resetState(),this._ws=null)},h.prototype._wsOnMessage=function(a){var b,c,d,g,h,i=this;switch(this._log("[wampy] websocket message received",a.data),b=this._decode(a.data),b[0]){case e.WELCOME:this._cache.sessionId=b[1],this._cache.server_wamp_features=b[2],this._cache.reconnectingAttempts?(this._cache.reconnectingAttempts=0,this._renewSubscriptions(),this._renewRegistrations()):this._options.onConnect&&this._options.onConnect(),this._send();break;case e.ABORT:this._options.onError&&this._options.onError(b[1].message?b[1].message:b[2]),this._ws.close();break;case e.CHALLENGE:break;case e.GOODBYE:this._cache.isSayingGoodbye||(this._cache.isSayingGoodbye=!0,this._send([e.GOODBYE,{},"wamp.error.goodbye_and_out"])),this._cache.sessionId=null,this._ws.close();break;case e.HEARTBEAT:break;case e.ERROR:switch(b[1]){case e.SUBSCRIBE:case e.UNSUBSCRIBE:this._requests[b[2]]?(this._requests[b[2]].callbacks.onError&&this._requests[b[2]].callbacks.onError(b[4]),delete this._requests[b[2]]):this._cache.opStatus=f.NON_EXIST_SUBSCRIBE_ERROR;break;case e.PUBLISH:this._requests[b[2]]?(this._requests[b[2]].callbacks.onError&&this._requests[b[2]].callbacks.onError(b[4]),delete this._requests[b[2]]):this._cache.opStatus=f.NON_EXIST_PUBLISH_ERROR;break;case e.REGISTER:case e.UNREGISTER:this._requests[b[2]]?(this._requests[b[2]].callbacks.onError&&this._requests[b[2]].callbacks.onError(b[4]),delete this._requests[b[2]]):this._cache.opStatus=f.NON_EXIST_RPC_ERROR;break;case e.INVOCATION:break;case e.CALL:if(this._calls[b[2]]){if(this._calls[b[2]].onError){switch(b.length){case 5:g=null;break;case 6:g=b[5];break;case 7:g=b[6]}this._calls[b[2]].onError(g)}delete this._calls[b[2]]}else this._cache.opStatus=f.NON_EXIST_CALL_ERROR}break;case e.SUBSCRIBED:this._requests[b[1]]?(this._subscriptions[this._requests[b[1]].topic]=this._subscriptions[b[2]]={id:b[2],callbacks:[this._requests[b[1]].callbacks.onEvent]},this._subsTopics.push(this._requests[b[1]].topic),this._requests[b[1]].callbacks.onSuccess&&this._requests[b[1]].callbacks.onSuccess(),delete this._requests[b[1]]):this._cache.opStatus=f.NON_EXIST_SUBSCRIBE_CONFIRM;break;case e.UNSUBSCRIBED:this._requests[b[1]]?(c=this._subscriptions[this._requests[b[1]].topic].id,delete this._subscriptions[this._requests[b[1]].topic],delete this._subscriptions[c],d=this._subsTopics.indexOf(this._requests[b[1]].topic),d>=0&&this._subsTopics.splice(d,1),this._requests[b[1]].callbacks.onSuccess&&this._requests[b[1]].callbacks.onSuccess(),delete this._requests[b[1]]):this._cache.opStatus=f.NON_EXIST_SUBSCRIBE_UNSUBSCRIBED;break;case e.PUBLISHED:this._requests[b[1]]?(this._requests[b[1]].callbacks&&this._requests[b[1]].callbacks.onSuccess&&this._requests[b[1]].callbacks.onSuccess(),delete this._requests[b[1]]):this._cache.opStatus=f.NON_EXIST_PUBLISH_PUBLISHED;break;case e.EVENT:if(this._subscriptions[b[1]]){switch(b.length){case 4:g=null;break;case 5:g=b[4];break;case 6:g=b[5]}for(d=this._subscriptions[b[1]].callbacks.length;d--;)this._subscriptions[b[1]].callbacks[d](g)}else this._cache.opStatus=f.NON_EXIST_SUBSCRIBE_EVENT;break;case e.RESULT:if(this._calls[b[1]]){switch(b.length){case 3:g=null;break;case 4:g=b[3];break;case 5:g=b[4]}this._calls[b[1]].onSuccess(g),b[2].progress&&b[2].progress===!0||delete this._calls[b[1]]}else this._cache.opStatus=f.NON_EXIST_CALL_RESULT;break;case e.REGISTER:break;case e.REGISTERED:this._requests[b[1]]?(this._rpcRegs[this._requests[b[1]].topic]=this._rpcRegs[b[2]]={id:b[2],callbacks:[this._requests[b[1]].callbacks.rpc]},this._rpcNames.push(this._requests[b[1]].topic),this._requests[b[1]].callbacks&&this._requests[b[1]].callbacks.onSuccess&&this._requests[b[1]].callbacks.onSuccess(),delete this._requests[b[1]]):this._cache.opStatus=f.NON_EXIST_RPC_REG;break;case e.UNREGISTER:break;case e.UNREGISTERED:this._requests[b[1]]?(c=this._rpcRegs[this._requests[b[1]].topic].id,delete this._rpcRegs[this._requests[b[1]].topic],delete this._rpcRegs[c],d=this._rpcNames.indexOf(this._requests[b[1]].topic),d>=0&&this._rpcNames.splice(d,1),this._requests[b[1]].callbacks&&this._requests[b[1]].callbacks.onSuccess&&this._requests[b[1]].callbacks.onSuccess(),delete this._requests[b[1]]):this._cache.opStatus=f.NON_EXIST_RPC_UNREG;break;case e.INVOCATION:if(this._rpcRegs[b[2]]){switch(b.length){case 4:g=null;break;case 5:g=b[4];break;case 6:g=b[5]}Promise.resolve(this._rpcRegs[b[2]].callbacks[0](g)).then(function(a){h=i._isArray(a)?[e.YIELD,b[1],{},a]:i._isPlainObject(a)?[e.YIELD,b[1],{},[],a]:"undefined"==typeof a?[e.YIELD,b[1],{}]:[e.YIELD,b[1],{},[a]],i._send(h)},function(a){i._send([e.ERROR,e.INVOCATION,b[1],{},"wamp.error.invocation_exception"])})}else this._send([e.ERROR,e.INVOCATION,b[1],{},"wamp.error.no_such_procedure"]),this._cache.opStatus=f.NON_EXIST_RPC_INVOCATION;break;case e.INTERRUPT:break;case e.YIELD:}},h.prototype._wsOnError=function(a){this._log("[wampy] websocket error"),this._options.onError&&this._options.onError(a)},h.prototype._wsReconnect=function(){this._log("[wampy] websocket reconnecting..."),this._options.onReconnect&&this._options.onReconnect(),this._cache.reconnectingAttempts++,this._ws=d(this._url,this._protocols,this._options.ws),this._initWsCallbacks()},h.prototype._renewSubscriptions=function(){var a,b,c=this._subscriptions,d=this._subsTopics;for(this._subscriptions={},this._subsTopics=[],a=d.length;a--;)for(b=c[d[a]].callbacks.length;b--;)this.subscribe(d[a],c[d[a]].callbacks[b])},h.prototype._renewRegistrations=function(){var a,b=this._rpcRegs,c=this._rpcNames;for(this._rpcRegs={},this._rpcNames=[],a=c.length;a--;)this.register(c[a],{rpc:b[c[a]].callbacks[0]})},h.prototype.options=function(a){return"undefined"==typeof a?this._options:this._isPlainObject(a)?(this._options=this._merge(this._options,a),this):void 0},h.prototype.getOpStatus=function(){return this._cache.opStatus},h.prototype.getSessionId=function(){return this._cache.sessionId},h.prototype.connect=function(a){return a&&(this._url=a),this._options.realm?(this._setWsProtocols(),this._ws=d(this._url,this._protocols,this._options.ws),this._ws?this._initWsCallbacks():this._cache.opStatus=f.NO_WS_OR_URL):this._cache.opStatus=f.NO_REALM,this},h.prototype.disconnect=function(){return this._cache.sessionId?(this._cache.isSayingGoodbye=!0,this._send([e.GOODBYE,{},"wamp.error.system_shutdown"])):this._ws&&this._ws.close(),this._cache.opStatus=f.SUCCESS,this},h.prototype.abort=function(){return this._cache.sessionId||1!==this._ws.readyState||(this._send([e.ABORT,{},"wamp.error.abort"]),this._cache.sessionId=null),this._ws.close(),this._cache.opStatus=f.SUCCESS,this},h.prototype.subscribe=function(a,b){var c;if(this._cache.sessionId&&!this._cache.server_wamp_features.roles.broker)return this._cache.opStatus=f.NO_BROKER,this._isPlainObject(b)&&b.onError&&b.onError(this._cache.opStatus.description),this;if(!this._validateURI(a))return this._cache.opStatus=f.URI_ERROR,this._isPlainObject(b)&&b.onError&&b.onError(this._cache.opStatus.description),this;if("function"==typeof b)b={onEvent:b};else if(!this._isPlainObject(b)||"undefined"==typeof b.onEvent)return this._cache.opStatus=f.NO_CALLBACK_SPEC,this._isPlainObject(b)&&b.onError&&b.onError(this._cache.opStatus.description),this;return this._subscriptions[a]&&this._subscriptions[a].callbacks.length?(this._subscriptions[a].callbacks.indexOf(b.onEvent)<0&&this._subscriptions[a].callbacks.push(b.onEvent),b.onSuccess&&b.onSuccess()):(c=this._getReqId(),this._requests[c]={topic:a,callbacks:b},this._send([e.SUBSCRIBE,c,{},a])),this._cache.opStatus=f.SUCCESS,this._cache.opStatus.reqId=c,this},h.prototype.unsubscribe=function(a,b){var c,d=-1;return this._cache.sessionId&&!this._cache.server_wamp_features.roles.broker?(this._cache.opStatus=f.NO_BROKER,this._isPlainObject(b)&&b.onError&&b.onError(this._cache.opStatus.description),this):this._subscriptions[a]?(c=this._getReqId(),"undefined"==typeof b?(this._subscriptions[a].callbacks=[],b={}):"function"==typeof b?(d=this._subscriptions[a].callbacks.indexOf(b),b={}):b.onEvent&&"function"==typeof b.onEvent?d=this._subscriptions[a].callbacks.indexOf(b.onEvent):this._subscriptions[a].callbacks=[],d>=0&&this._subscriptions[a].callbacks.splice(d,1),this._subscriptions[a].callbacks.length?(this._cache.opStatus=f.SUCCESS,this):(this._requests[c]={topic:a,callbacks:b},this._send([e.UNSUBSCRIBE,c,this._subscriptions[a].id]),this._cache.opStatus=f.SUCCESS,this._cache.opStatus.reqId=c,this)):(this._cache.opStatus=f.NON_EXIST_UNSUBSCRIBE,this._isPlainObject(b)&&b.onError&&b.onError(this._cache.opStatus.description),this)},h.prototype.publish=function(a,b,c,d){var g,h,i={},j=!1;if(this._cache.sessionId&&!this._cache.server_wamp_features.roles.broker)return this._cache.opStatus=f.NO_BROKER,this._isPlainObject(c)&&c.onError&&c.onError(this._cache.opStatus.description),this;if(!this._validateURI(a))return this._cache.opStatus=f.URI_ERROR,this._isPlainObject(c)&&c.onError&&c.onError(this._cache.opStatus.description),this;if(this._isPlainObject(c)&&(i.acknowledge=!0),"undefined"!=typeof d&&(this._isPlainObject(d)?(d.exclude&&(this._isArray(d.exclude)?i.exclude=d.exclude:"number"==typeof d.exclude?i.exclude=[d.exclude]:j=!0),d.eligible&&(this._isArray(d.eligible)?i.eligible=d.eligible:"number"==typeof d.eligible?i.eligible=[d.eligible]:j=!0),d.hasOwnProperty("exclude_me")&&(i.exclude_me=d.exclude_me!==!1),d.hasOwnProperty("disclose_me")&&(i.disclose_me=d.disclose_me===!0)):j=!0,j))return this._cache.opStatus=f.INVALID_PARAM,this._isPlainObject(c)&&c.onError&&c.onError(this._cache.opStatus.description),this;switch(g=this._getReqId(),arguments.length){case 1:h=[e.PUBLISH,g,i,a];break;case 2:h=this._isArray(b)?[e.PUBLISH,g,i,a,b]:this._isPlainObject(b)?[e.PUBLISH,g,i,a,[],b]:[e.PUBLISH,g,i,a,[b]];break;default:this._requests[g]={topic:a,callbacks:c},h=this._isArray(b)?[e.PUBLISH,g,i,a,b]:this._isPlainObject(b)?[e.PUBLISH,g,i,a,[],b]:[e.PUBLISH,g,i,a,[b]]}return this._send(h),this._cache.opStatus=f.SUCCESS,this._cache.opStatus.reqId=g,this},h.prototype.call=function(a,b,c,d){var g,h,i={},j=!1;if(this._cache.sessionId&&!this._cache.server_wamp_features.roles.dealer)return this._cache.opStatus=f.NO_DEALER,this._isPlainObject(c)&&c.onError&&c.onError(this._cache.opStatus.description),this;if(!this._validateURI(a))return this._cache.opStatus=f.URI_ERROR,this._isPlainObject(c)&&c.onError&&c.onError(this._cache.opStatus.description),this;if("function"==typeof c)c={onSuccess:c};else if(!this._isPlainObject(c)||"undefined"==typeof c.onSuccess)return this._cache.opStatus=f.NO_CALLBACK_SPEC,this._isPlainObject(c)&&c.onError&&c.onError(this._cache.opStatus.description),this;if("undefined"!=typeof d&&(this._isPlainObject(d)?(d.exclude&&(this._isArray(d.exclude)?i.exclude=d.exclude:"number"==typeof d.exclude?i.exclude=[d.exclude]:j=!0),d.eligible&&(this._isArray(d.eligible)?i.eligible=d.eligible:"number"==typeof d.eligible?i.eligible=[d.eligible]:j=!0),d.hasOwnProperty("exclude_me")&&(i.exclude_me=d.exclude_me!==!1),d.hasOwnProperty("disclose_me")&&(i.disclose_me=d.disclose_me===!0),d.hasOwnProperty("receive_progress")&&(i.receive_progress=d.receive_progress===!0)):j=!0,j))return this._cache.opStatus=f.INVALID_PARAM,this._isPlainObject(c)&&c.onError&&c.onError(this._cache.opStatus.description),this;do g=this._getReqId();while(g in this._calls);return this._calls[g]=c,h=null===b?[e.CALL,g,i,a]:this._isArray(b)?[e.CALL,g,i,a,b]:this._isPlainObject(b)?[e.CALL,g,i,a,[],b]:[e.CALL,g,i,a,[b]],this._send(h),this._cache.opStatus=f.SUCCESS,this._cache.opStatus.reqId=g,this},h.prototype.cancel=function(a,b,c){var d={mode:"skip"};return this._cache.sessionId&&!this._cache.server_wamp_features.roles.dealer?(this._cache.opStatus=f.NO_DEALER,this._isPlainObject(b)&&b.onError&&b.onError(this._cache.opStatus.description),this):a&&this._calls[a]?("undefined"!=typeof c&&this._isPlainObject(c)&&c.hasOwnProperty("mode")&&(d.mode=/skip|kill|killnowait/.test(c.mode)?c.mode:"skip"),this._send([e.CANCEL,a,d]),b.onSuccess&&b.onSuccess(),this._cache.opStatus=f.SUCCESS,this._cache.opStatus.reqId=a,this):(this._cache.opStatus=f.NON_EXIST_RPC_REQ_ID,this._isPlainObject(b)&&b.onError&&b.onError(this._cache.opStatus.description),this)},h.prototype.register=function(a,b){var c;if(this._cache.sessionId&&!this._cache.server_wamp_features.roles.dealer)return this._cache.opStatus=f.NO_DEALER,this._isPlainObject(b)&&b.onError&&b.onError(this._cache.opStatus.description),this;if(!this._validateURI(a))return this._cache.opStatus=f.URI_ERROR,this._isPlainObject(b)&&b.onError&&b.onError(this._cache.opStatus.description),this;if("function"==typeof b)b={rpc:b};else if(!this._isPlainObject(b)||"undefined"==typeof b.rpc)return this._cache.opStatus=f.NO_CALLBACK_SPEC,this._isPlainObject(b)&&b.onError&&b.onError(this._cache.opStatus.description),this;return this._rpcRegs[a]&&this._rpcRegs[a].callbacks.length?(this._cache.opStatus=f.RPC_ALREADY_REGISTERED,this._isPlainObject(b)&&b.onError&&b.onError(this._cache.opStatus.description)):(c=this._getReqId(),this._requests[c]={topic:a,callbacks:b},this._send([e.REGISTER,c,{},a]),this._cache.opStatus=f.SUCCESS,this._cache.opStatus.reqId=c),this},h.prototype.unregister=function(a,b){var c;return this._cache.sessionId&&!this._cache.server_wamp_features.roles.dealer?(this._cache.opStatus=f.NO_DEALER,this._isPlainObject(b)&&b.onError&&b.onError(this._cache.opStatus.description),this):this._validateURI(a)?("function"==typeof b&&(b={onSuccess:b}),this._rpcRegs[a]?(c=this._getReqId(),this._requests[c]={topic:a,callbacks:b},this._send([e.UNREGISTER,c,this._rpcRegs[a].id]),this._cache.opStatus=f.SUCCESS,this._cache.opStatus.reqId=c):(this._cache.opStatus=f.NON_EXIST_RPC_UNREG,this._isPlainObject(b)&&b.onError&&b.onError(this._cache.opStatus.description)),this):(this._cache.opStatus=f.URI_ERROR,this._isPlainObject(b)&&b.onError&&b.onError(this._cache.opStatus.description),this)},a.Wampy=h}module.exports=factory;
//# sourceMappingURL=wampy.min.js.map